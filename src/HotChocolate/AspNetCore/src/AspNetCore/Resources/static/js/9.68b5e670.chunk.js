(this["webpackJsonp@banana-cake-pop/main"]=this["webpackJsonp@banana-cake-pop/main"]||[]).push([[9],{435:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,a,c,o,i=n(171),u=n(405),d=n(68),s=n(164),l=n(400),b=n(393),f=n(88),m=Object(d.memo)(Object(d.forwardRef)((function(e,t){var n=e.searchTerm,r=e.onSearchTermChange,a=Object(d.useRef)(null),c=Object(d.useRef)(null),o=Object(u.a)((function(e){r(e.target.value.trim())}),250,[r]),i=Object(d.useCallback)((function(e){o(e),c.current.style.display=e.currentTarget.value.length>0?"flex":"none"}),[o]),s=Object(d.useCallback)((function(){var e;null===(e=a.current)||void 0===e||e.focus()}),[]);return Object(d.useEffect)((function(){var e=a.current,t=c.current;n&&n.length>0?(e.value=n,t.style.display="flex"):t.style.display="none"}),[n]),Object(f.jsx)(p,{ref:t,onClick:s,children:Object(f.jsxs)(h,{children:[Object(f.jsx)(j,{children:Object(f.jsx)(b.w,{})}),Object(f.jsx)(x,{ref:a,placeholder:"Find...",onChange:i}),Object(f.jsx)(l.c,{ref:c,onClick:function(){r(""),a.current.value="",c.current.style.display="none"},children:Object(f.jsx)(b.i,{})})]})})}))),p=s.d.div(r||(r=Object(i.a)(["\n  z-index: 1;\n  display: flex;\n  flex: 0 0 auto;\n  flex-direction: row;\n  align-items: center;\n  height: 44px;\n  max-height: 44px;\n  padding: 0 8px;\n"]))),j=s.d.div(a||(a=Object(i.a)(["\n  display: flex;\n  flex: 0 0 24px;\n  align-items: center;\n  justify-content: center;\n\n  & > svg {\n    fill: "," !important;\n  }\n"])),(function(e){return e.theme.accentColor1})),x=s.d.input(c||(c=Object(i.a)(["\n  flex: 1 1 auto;\n  border: 0 none;\n  padding: 0 9px;\n  color: ",";\n  background-color: ",";\n  transition: background-color 0.2s ease;\n  user-select: initial;\n"])),(function(e){return e.theme.accentColor1}),(function(e){return e.theme.accentColor4})),h=s.d.div(o||(o=Object(i.a)(["\n  display: flex;\n  flex: 1 1 auto;\n  align-items: center;\n  border-radius: 8px;\n  border: 1px solid ",";\n  padding: 0 5px;\n  height: 30px;\n  background-color: ",";\n  transition: background-color 0.2s ease, border-color 0.2s ease,\n    box-shadow 0.2s ease;\n  cursor: text;\n\n  &:focus-within {\n    border-color: ",";\n    background-color: ",";\n    box-shadow: 0 0 4px 0 ",";\n\n    & > "," {\n      background-color: ",";\n    }\n  }\n\n  &:hover {\n    background-color: ",";\n\n    & > "," {\n      background-color: ",";\n    }\n  }\n"])),(function(e){return e.theme.accentColor3}),(function(e){return e.theme.accentColor4}),(function(e){return e.theme.mainColor}),(function(e){return e.theme.mainColor}),(function(e){return e.theme.accentColor1}),x,(function(e){return e.theme.mainColor}),(function(e){return e.theme.mainColor}),x,(function(e){return e.theme.mainColor}))},633:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return q}));var r=n(6),a=n(11),c=n.n(a),o=n(392),i=n(384),u=n(433),d=n(68),s=n(428);function l(e,t){var n;return e?t?t.expandable?t:null!==(n=t.parent)&&void 0!==n?n:e:e:void 0}function b(e){var t=Object(s.createDocumentId)();return e.triggerCreate({name:"",expandable:!1,metadata:{id:t,kind:"document"}})}function f(e){var t=Object(s.createFolderId)();return e.triggerCreate({name:"",expandable:!0,metadata:{id:t,kind:"folder"}})}var m=n(88),p="root-menu",j=function(){var e=Object(i.f)(p),t=Object(d.useCallback)(Object(o.a)(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return n=e.item.treeModel,t.next=4,f(n);case 4:e.hide();case 5:case"end":return t.stop()}}),t)}))),[e]),n=Object(d.useCallback)(Object(o.a)(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return n=e.item.treeModel,t.next=4,b(n);case 4:e.hide();case 5:case"end":return t.stop()}}),t)}))),[e]);return Object(m.jsxs)(u.b,{id:p,children:[Object(m.jsx)(u.a,{onClick:n,children:"New Document"}),Object(m.jsx)(u.a,{onClick:t,children:"New Folder"})]})};var x=n(455),h=n(386),O=n(400),v=n(435),k=n(389),w=n(393),C=n(415),g=n(401),y=n(395),I=n(408),N=n(383),F=n(637),D=n(452),T=n(423),P=n(407),M=n(432),R=n(600);var A=n(424);function S(e){var t=Object(i.f)(e);return Object(d.useCallback)(Object(o.a)(c.a.mark((function e(){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}if(n=t.item.node,!(r=l(n.model,n))){e.next=6;break}return e.next=6,f(r);case 6:t.hide();case 7:case"end":return e.stop()}}),e)}))),[t])}function E(e){var t=Object(i.f)(e);return Object(d.useCallback)(Object(o.a)(c.a.mark((function e(){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}if(n=t.item.node,!(r=l(n.model,n))){e.next=6;break}return e.next=6,b(r);case 6:t.hide();case 7:case"end":return e.stop()}}),e)}))),[t])}function H(e){var t=Object(i.f)(e);return Object(d.useCallback)(Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(t.item.node.triggerRename(),t.hide());case 1:case"end":return e.stop()}}),e)}))),[t])}var L="document-menu",z=function(){var e=Object(N.b)(),t=Object(A.a)(L),n=E(L),r=S(L),a=H(L),c=Object(d.useCallback)((function(){if(t){var n,r=t.item.node;(null!==(n=r.parent)&&void 0!==n?n:r.model).remove(r),e(h.a.deleteDocument({documentId:r.metadata.id})),t.hide()}}),[t,e]);return Object(m.jsxs)(u.b,{id:L,children:[Object(m.jsx)(u.a,{onClick:a,children:"Rename"}),Object(m.jsx)(u.a,{onClick:n,children:"New Document"}),Object(m.jsx)(u.a,{onClick:r,children:"New Folder"}),Object(m.jsx)(u.a,{onClick:c,children:"Delete"})]})};var J="folder-menu",V=function(){var e=Object(N.b)(),t=Object(A.a)(J),n=E(J),r=S(J),a=H(J),c=Object(d.useCallback)((function(){if(t){var n,r=t.item.node;(null!==(n=r.parent)&&void 0!==n?n:r.model).remove(r),e(h.a.deleteFolder({folderId:r.metadata.id})),t.hide()}}),[t,e]);return Object(m.jsxs)(u.b,{id:J,children:[Object(m.jsx)(u.a,{onClick:a,children:"Rename"}),Object(m.jsx)(u.a,{onClick:n,children:"New Document"}),Object(m.jsx)(u.a,{onClick:r,children:"New Folder"}),Object(m.jsx)(u.a,{onClick:c,children:"Delete"})]})};var q=function(){var e=Object(N.b)(),t=Object(y.b)(g.b.selectActiveNodeId),n=Object(y.c)(x.b.selectSearchTerm),a=Object(d.useRef)([]),i=Object(d.useRef)(),s=Object(u.c)(L),A=Object(u.c)(J),S=Object(u.c)(p),E=function(e){return{getNodes:function(t,n,r){return e.pipe(Object(F.a)(1),Object(R.a)((function(e){return Object(M.b)(P.b,null===n||void 0===n?void 0:n.metadata.id,r?function(e){return r({name:e})}:void 0).then((function(t){return function(e,t,n){return e.map((function(e){return{name:e.name,expanded:t.includes(e.id)||n,expandable:"folder"===e.kind,metadata:{id:e.id,kind:"folder"===e.kind?"folder":"document"}}}))}(t,e,!!r)}))}))).toPromise()},validate:function(e,t){return Object(o.a)(c.a.mark((function n(){var r,a,o;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==(r=T.a.getSegments(e)).length){n.next=3;break}return n.abrupt("return",Promise.resolve(D.a.fail("An empty path is invalid.")));case 3:return a=t?t.metadata.id:P.b,o=r[r.length-1],n.next=7,Object(M.d)(a,o);case 7:if(!n.sent){n.next=9;break}return n.abrupt("return",Promise.resolve(D.a.fail('A document with name "'.concat(r[1],'" already exists.'))));case 9:return n.abrupt("return",Promise.resolve(D.a.success()));case 10:case"end":return n.stop()}}),n)})))()}}}(Object(y.b)(x.b.selectExpandedFolders)),H=Object(d.useCallback)((function(e,t){if(!t.metadata)throw new Error("Metadata should be there.");switch(t.metadata.kind){case"folder":A(e,{node:t});break;case"document":s(e,{node:t})}}),[s,A]),q=Object(d.useCallback)((function(e){S(e,{treeModel:i.current})}),[S]),G=Object(I.b)((function(t){var n=t.e,r=t.node,a=t.isPreview;switch(n.preventDefault(),n.stopPropagation(),r.selected||(Object(C.f)(r.model),r.selected=!0),r.metadata.kind){case"document":e(h.a.activateOrOpenDocument({documentId:r.metadata.id,isHistory:!1,isPreview:a}));break;case"folder":r.toggleExpanded(),e(g.a.activateNode({id:r.metadata.id}))}}),25),K=function(e,t){return G({e:e,node:t,isPreview:!0})},Q=function(e,t){return G({e:e,node:t,isPreview:!1})},U=function(t){e(x.a.collapseFolder({folderId:t.metadata.id}))},W=function(){var t=Object(o.a)(c.a.mark((function t(n){var r,a,o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"document"===n.metadata.kind?n.metadata.exists?(n.metadata.closeTabAfterCreation?e(h.a.saveAndCloseNewDocument({documentId:n.metadata.id,documentName:n.name,folderId:null===(r=n.parent)||void 0===r?void 0:r.metadata.id,isHistory:!1})):e(h.a.saveNewDocument({documentId:n.metadata.id,documentName:n.name,folderId:null===(a=n.parent)||void 0===a?void 0:a.metadata.id,isHistory:!1})),delete n.metadata.exists,delete n.metadata.closeTabAfterCreation):e(h.a.createAndSaveDocument({documentId:n.metadata.id,documentName:n.name,folderId:null===(o=n.parent)||void 0===o?void 0:o.metadata.id})):e(h.a.createFolder({folderId:n.metadata.id,folderName:n.name,parentFolderId:null===(i=n.parent)||void 0===i?void 0:i.metadata.id}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),X=function(t){e(x.a.expandFolder({folderId:t.metadata.id}))},Y=function(t){"document"===t.metadata.kind?e(h.a.renameDocument({documentId:t.metadata.id,name:t.name})):e(h.a.renameFolder({folderId:t.metadata.id,newFolderName:t.name}))},Z=function(e){t.pipe(Object(F.a)(1)).subscribe(function(){var t=Object(o.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,re(e,n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},$=function(){var e=Object(o.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=l(i.current,null===(t=i.current)||void 0===t?void 0:t.selectedNodes[0]))){e.next=4;break}return e.next=4,b(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(o.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=l(i.current,null===(t=i.current)||void 0===t?void 0:t.selectedNodes[0]))){e.next=4;break}return e.next=4,f(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var t=Object(o.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e(x.a.changeDocumentSearchTerm({searchTerm:n})),!i.current){t.next=9;break}if(!(n.length>0)){t.next=7;break}return t.next=5,i.current.setFilter((function(e){return-1!==e.name.toLowerCase().indexOf(n.toLowerCase())}));case 5:t.next=9;break;case 7:return t.next=9,i.current.resetFilter();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function te(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.selected||(Object(C.f)(t.model),t.selected=!0),e.next=3,t.ensureVisible();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t){return ae.apply(this,arguments)}function ae(){return(ae=Object(o.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=10;break}if(!(r=t.find((function(e){return e.metadata&&e.metadata.id&&e.metadata.id===n})))){e.next=7;break}return e.next=5,te(r);case 5:e.next=8;break;case 7:Object(C.f)(t);case 8:e.next=11;break;case 10:Object(C.f)(t);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(d.useEffect)((function(){var e=a.current;return function(){for(var t;t=e.pop();)t();i.current=void 0}}),[]),Object(m.jsx)(k.k,{children:Object(m.jsxs)(k.a,{children:[Object(m.jsxs)(k.c,{children:[Object(m.jsx)(k.i,{children:"Documents"}),Object(m.jsx)(k.h,{}),Object(m.jsx)(O.c,{title:"New document",onClick:$,children:Object(m.jsx)(w.r,{})}),Object(m.jsx)(O.c,{title:"New folder",onClick:_,children:Object(m.jsx)(w.s,{})})]}),Object(m.jsx)(v.a,{searchTerm:n,onSearchTermChange:ee}),Object(m.jsx)(k.j,{children:Object(m.jsx)(C.c,{id:"documents",itemHeight:C.b,provider:E,onContextMenu:q,onInitialized:function(e){var u=t.subscribe(function(){var t=Object(o.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,re(e,n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),d=e.subscribeFor(function(){var t=Object(o.a)(c.a.mark((function t(n){var a,o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Object(r.a)(n),t.prev=1,a.s();case 3:if((o=a.n()).done){t.next=23;break}i=o.value,t.t0=i.kind,t.next="collapsed"===t.t0?8:"created"===t.t0?10:"expanded"===t.t0?13:"renamed"===t.t0?15:"reset-filter"===t.t0?17:"set-filter"===t.t0?19:21;break;case 8:return U(i.node),t.abrupt("break",21);case 10:return t.next=12,W(i.node);case 12:return t.abrupt("break",21);case 13:return X(i.node),t.abrupt("break",21);case 15:return Y(i.node),t.abrupt("break",21);case 17:case 19:return Z(e),t.abrupt("break",21);case 21:t.next=3;break;case 23:t.next=28;break;case 25:t.prev=25,t.t1=t.catch(1),a.e(t.t1);case 28:return t.prev=28,a.f(),t.finish(28);case 31:case"end":return t.stop()}}),t,null,[[1,25,28,31]])})));return function(e){return t.apply(this,arguments)}}(),"collapsed","created","expanded","renamed","reset-filter","set-filter");n&&n.length>0&&e.setFilter((function(e){return-1!==e.name.toLowerCase().indexOf(n.toLowerCase())})),a.current.push((function(){return u.unsubscribe()})),a.current.push((function(){return d()})),i.current=e},children:function(e){return Object(m.jsx)(C.d,{id:e.id,depth:e.depth,name:e.name,path:e.path,expanded:e.expanded,expandable:e.expandable,node:e,onClick:K,onDoubleClick:Q,onContextMenu:H,renderIcon:B})}})}),Object(m.jsx)(V,{}),Object(m.jsx)(z,{}),Object(m.jsx)(j,{})]})})};function B(e){return"folder"===e.metadata.kind?Object(m.jsx)(C.e,{color:"yellow",children:e.expanded?Object(m.jsx)(w.n,{}):"creation"===e.editMode?Object(m.jsx)(w.s,{}):Object(m.jsx)(w.m,{})}):Object(m.jsx)(C.e,{color:"blue",children:"creation"===e.editMode?Object(m.jsx)(w.r,{}):Object(m.jsx)(w.k,{})})}}}]);