<Project>
  <Import Project="$([MSBuild]::GetPathOfFileAbove('Directory.Build.props', '$(MSBuildThisFileDirectory)..\..\..\'))" />

  <Target Name="GenerateVersionInfo" BeforeTargets="CoreCompile"
          Condition="'$(GenerateVersionInfo)'=='true'">
    <PropertyGroup>
      <VersionInfoFile>$(IntermediateOutputPath)VersionInfo.g.cs</VersionInfoFile>
    </PropertyGroup>
    <ItemGroup>
      <Compile Include="$(VersionInfoFile)"/>
    </ItemGroup>
    <WriteLinesToFile
      File="$(VersionInfoFile)"
      Lines="namespace $(RootNamespace) { internal static class VersionInfo { public const string PackageVersion = &quot;$(PackageVersion)&quot; 	%3B} }"
      Overwrite="true"
      WriteOnlyWhenDifferent="true"
    />
  </Target>
</Project>
