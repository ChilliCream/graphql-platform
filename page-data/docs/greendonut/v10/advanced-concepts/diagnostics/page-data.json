{"componentChunkName":"component---src-templates-doc-page-template-tsx","path":"/docs/greendonut/v10/advanced-concepts/diagnostics","result":{"data":{"file":{"childMdx":{"fields":{"slug":"/greendonut/v10/advanced-concepts/diagnostics/"},"frontmatter":{"title":"Diagnostic Events"},"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Diagnostic Events\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"This library has recently added \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"DiagnosticSources\"), \" to offer an\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Instrumentation API\"), \" to collect diagnostic events. To get started we need to\\nadd \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"two\"), \" packages and implement \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"two\"), \" classes. So lets get started.\"), mdx(\"h1\", null, \"Installation\"), mdx(\"p\", null, \"We need to add the required packages.\"), mdx(\"p\", null, \"For \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \".Net Core\"), \" we use the dotnet CLI. Which is perhaps the most preferred way\\ndoing this.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"dotnet add package System.Diagnostics.DiagnosticSource\\ndotnet add package Microsoft.Extensions.DiagnosticAdapter\\n\")), mdx(\"p\", null, \"And for \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \".Net Framework\"), \" we still use the following line.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-powershell\"\n  }), \"Install-Package System.Diagnostics.DiagnosticSource\\nInstall-Package Microsoft.Extensions.DiagnosticAdapter\\n\")), mdx(\"h1\", null, \"Implement Diagnostic Listener\"), mdx(\"p\", null, \"After we added those two packages we can start listening to Green Donut\\ndiagnostic events by implementing a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"DiagnosticListener\"), \".\"), mdx(\"p\", null, \"First we implement the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"DiagnosticListener\"), \".\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-csharp\"\n  }), \"using System;\\nusing System.Collections.Concurrent;\\nusing System.Collections.Generic;\\nusing System.Diagnostics;\\nusing Microsoft.Extensions.DiagnosticAdapter;\\n\\nnamespace Demo\\n{\\n    public class CustomListener\\n    {\\n        // here you see the complete set of diagnostic events we can listen to.\\n        // here we usually add just those events we want to listen to.\\n        // for example if we are not interested to get informed about values\\n        // loaded from the cache then we just remove the complete method.\\n\\n        [DiagnosticName(\\\"GreenDonut.ExecuteBatchRequest\\\")]\\n        public void EnableExecuteBatchRequest()\\n        {\\n            // this event remains empty. it is required to enable the fetch\\n            // activity. if you remove this event, ExecuteBatchRequest.Start and\\n            // ExecuteBatchRequest.Stop stop working.\\n        }\\n\\n        [DiagnosticName(\\\"GreenDonut.ExecuteBatchRequest.Start\\\")]\\n        public void HandleExecuteBatchRequestStart(\\n            IReadOnlyList<object> keys)\\n        {\\n            // here goes our code to handle activity start.\\n        }\\n\\n        [DiagnosticName(\\\"GreenDonut.ExecuteBatchRequest.Stop\\\")]\\n        public void HandleExecuteBatchRequestStop(\\n            IReadOnlyList<object> keys,\\n            IReadOnlyList<object> values)\\n        {\\n            // here goes our code to handle activity stop.\\n        }\\n\\n        [DiagnosticName(\\\"GreenDonut.ExecuteSingleRequest\\\")]\\n        public void EnableExecuteSingleRequest()\\n        {\\n            // this event remains empty. it is required to enable the fetch\\n            // activity. if you remove this event, ExecuteSingleRequest.Start\\n            // and ExecuteSingleRequest.Stop stop working.\\n        }\\n\\n        [DiagnosticName(\\\"GreenDonut.ExecuteSingleRequest.Start\\\")]\\n        public void HandleExecuteSingleRequestStart(\\n            object key)\\n        {\\n            // here goes our code to handle activity start.\\n        }\\n\\n        [DiagnosticName(\\\"GreenDonut.ExecuteSingleRequest.Stop\\\")]\\n        public void HandleExecuteSingleRequestStop(\\n            object key,\\n            IReadOnlyList<object> values)\\n        {\\n            // here goes our code to handle activity stop.\\n        }\\n\\n        [DiagnosticName(\\\"GreenDonut.BatchError\\\")]\\n        public void HandleBatchError(\\n            IReadOnlyList<object> keys,\\n            Exception exception)\\n        {\\n            // here goes our code to handle batch errors which occur during\\n            // fetch.\\n        }\\n\\n        [DiagnosticName(\\\"GreenDonut.CachedValue\\\")]\\n        public void HandleCachedValue(object key, object cacheKey, object value)\\n        {\\n            // here goes our code to handle values coming from the cache.\\n        }\\n\\n        [DiagnosticName(\\\"GreenDonut.Error\\\")]\\n        public void HandleError(object key, Exception exception)\\n        {\\n            // here goes our code to handle result errors which occur during\\n            // fetch.\\n        }\\n    }\\n}\\n\")), mdx(\"p\", null, \"Then we need to implement an \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Observer\"), \" to subscribe to the Green Donut\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"DiagnosticSource\"), \" which produces the diagnostic events.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-csharp\"\n  }), \"using System;\\nusing System.Diagnostics;\\n\\nnamespace Demo\\n{\\n    public class CustomObserver\\n        : IObserver<DiagnosticListener>\\n    {\\n        private readonly CustomListener _listener;\\n\\n        public CustomObserver(CustomListener listener)\\n        {\\n            _listener = listener ??\\n                throw new ArgumentNullException(nameof(listener));\\n        }\\n\\n        public void OnCompleted() { }\\n\\n        public void OnError(Exception error) { }\\n\\n        public void OnNext(DiagnosticListener value)\\n        {\\n            if (value.Name == \\\"GreenDonut\\\")\\n            {\\n                value.SubscribeWithAdapter(_listener);\\n            }\\n        }\\n    }\\n}\\n\")), mdx(\"h1\", null, \"Subscribe to Events\"), mdx(\"p\", null, \"Last but not least we must subscribe to the Green Donut \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"DiagnosticSource\"), \".\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-csharp\"\n  }), \"// subscribe\\nvar listener = new CustomListener();\\nvar observer = new CustomObserver(listener);\\nvar subscription = DiagnosticListener.AllListeners.Subscribe(observer);\\n\\n// unsubscribe\\nsubscription.Dispose();\\n\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Note\")), mdx(\"ul\", {\n    parentName: \"blockquote\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Remember to dispose your subscription if you would like to stop listening to\\ndiagnostic events.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Keep in mind that this code is not production ready. It is meant to give you\\nan idea how it works.\"))));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#installation","title":"Installation"},{"url":"#implement-diagnostic-listener","title":"Implement Diagnostic Listener"},{"url":"#subscribe-to-events","title":"Subscribe to Events"}]}}},"site":{"siteMetadata":{"siteUrl":"https://chillicream.com","repositoryUrl":"https://github.com/ChilliCream/hotchocolate","tools":{"slack":"http://bit.ly/joinchilli"}}},"config":{"products":[{"path":"hotchocolate","title":"Hot Chocolate","description":"Build your own thin GraphQL API layer on top of any resource.","versions":[{"path":"","title":"v11.1 (latest)","items":[{"path":"index","title":"Introduction","items":null},{"path":"get-started","title":"Get Started","items":null},{"path":"defining-a-schema","title":"Defining a schema","items":[{"path":"index","title":"Schema basics"},{"path":"descriptions","title":"Schema Documentation"},{"path":"operations","title":"Operations"},{"path":"versioning","title":"Versioning"},{"path":"unions-and-interfaces","title":"Unions and Interfaces"},{"path":"extending-types","title":"Extending types"},{"path":"scalars","title":"Scalars"},{"path":"directives","title":"Directives"}]},{"path":"fetching-data","title":"Fetching data","items":[{"path":"index","title":"Resolver"},{"path":"fetching-from-databases","title":"Fetching from Databases"},{"path":"fetching-from-rest","title":"Fetching from REST"},{"path":"dataloader","title":"DataLoader"},{"path":"pagination","title":"Pagination"},{"path":"filtering","title":"Filtering"},{"path":"sorting","title":"Sorting"},{"path":"projections","title":"Projections"}]},{"path":"distributed-schema","title":"Distributed Schemas","items":[{"path":"index","title":"Overview"},{"path":"schema-stitching","title":"Schema Stitching"},{"path":"schema-federations","title":"Schema Federations"},{"path":"schema-configuration","title":"Schema Configuration"}]},{"path":"integrations","title":"Integrations","items":[{"path":"index","title":"Overview"},{"path":"entity-framework","title":"Entity Framework"},{"path":"spatial-data","title":"Spatial Data"}]},{"path":"performance","title":"Performance","items":[{"path":"index","title":"Overview"},{"path":"persisted-queries","title":"Persisted queries"},{"path":"automatic-persisted-queries","title":"Automatic persisted queries"}]},{"path":"api-reference","title":"API Reference","items":[{"path":"index","title":"Overview"},{"path":"object-type","title":"Object Type"},{"path":"custom-attributes","title":"Custom Attributes"},{"path":"language","title":"Language"},{"path":"extending-filtering","title":"Extending Filtering"},{"path":"visitors","title":"Visitors"},{"path":"aspnetcore","title":"ASP.NET Core"},{"path":"executable","title":"Executable"},{"path":"apollo-tracing","title":"Apollo Tracing"},{"path":"migrate-from-10-to-11","title":"Migrate from 10.5 to 11.0"}]}]},{"path":"v10","title":"v10 (previous)","items":[{"path":"index","title":"Introduction","items":null},{"path":"code-first","title":"Code-First","items":null},{"path":"schema-first","title":"Schema-First","items":null},{"path":"schema","title":"Schema","items":[{"path":"index","title":"Schema"},{"path":"object-type","title":"Object Type"},{"path":"interface-type","title":"Interface Type"},{"path":"union-type","title":"Union Type"},{"path":"input-object-type","title":"Input Object Type"},{"path":"enum-type","title":"Enum Type"},{"path":"descriptions","title":"Schema Descriptions"},{"path":"custom-scalar-types","title":"Scalar Type Support"},{"path":"descriptor-attributes","title":"Descriptor Attributes"},{"path":"extending-types","title":"Custom Base Classes"},{"path":"directives","title":"Directives"},{"path":"resolvers","title":"Resolvers"},{"path":"relay","title":"Relay"},{"path":"conventions","title":"Conventions"},{"path":"options","title":"Schema Options"}]},{"path":"data-fetching","title":"Data Fetching","items":[{"path":"index","title":"Data Loaders"},{"path":"pagination","title":"Pagination"},{"path":"filters","title":"Filters"}]},{"path":"security","title":"Security","items":[{"path":"index","title":"Authorization"},{"path":"security","title":"Security"}]},{"path":"execution-engine","title":"Execution Engine","items":[{"path":"index","title":"Middleware"},{"path":"validation-rules","title":"Validation Rules"},{"path":"instrumentation","title":"Instrumentation"},{"path":"apollo-tracing","title":"Apollo Tracing"},{"path":"batching","title":"Batching"},{"path":"persisted-queries","title":"Persisted Queries"},{"path":"custom-context-data","title":"Custom Context Data"},{"path":"subscriptions","title":"Subscriptions"},{"path":"type-conversion","title":"Type Conversion"},{"path":"error-filter","title":"Error Filter"},{"path":"execution-options","title":"Execution Options"}]},{"path":"server","title":"Server","items":[{"path":"index","title":"ASP.Net"},{"path":"dependency-injection","title":"Dependency Injection"}]},{"path":"stitching","title":"Schema Stitching","items":null},{"path":"tooling","title":"Tooling","items":null},{"path":"advanced","title":"Advanced","items":[{"path":"index","title":"Parser"},{"path":"dotnet-cli","title":".Net CLI"}]},{"path":"tutorials","title":"Tutorials","items":[{"path":"index","title":"Entity Framework"}]},{"path":"examples","title":"Examples","items":[{"path":"index","title":"Star Wars"},{"path":"slack-clone","title":"Slack Clone"},{"path":"other-examples","title":"Other Examples"}]}]}]},{"path":"bananacakepop","title":"Banana Cake Pop","description":"Use this GUI to get deep insights from any GraphQL API.","versions":[{"path":"","title":"v1 (preview)","items":[{"path":"index","title":"Introduction","items":null}]}]},{"path":"strawberryshake","title":"Strawberry Shake","description":"The only GraphQL client you will every need in the .NET ecosystem.","versions":[{"path":"","title":"v11 (preview)","items":[{"path":"index","title":"Introduction","items":null},{"path":"get-started","title":"Get Started","items":[{"path":"index","title":"Blazor"},{"path":"xamarin","title":"Xamarin"},{"path":"console","title":"Console"}]},{"path":"subscriptions","title":"Subscriptions","items":null},{"path":"tooling","title":"Tooling / CLI","items":null},{"path":"caching","title":"Caching","items":[{"path":"index","title":"Overview"},{"path":"entities","title":"Entities"},{"path":"invalidation","title":"Invalidation"}]},{"path":"performance","title":"Performance","items":[{"path":"index","title":"Overview"},{"path":"persisted-queries","title":"Persisted Queries"},{"path":"persisted-state","title":"Persisted State"}]},{"path":"networking","title":"Networking","items":[{"path":"index","title":"Protocols"},{"path":"authentication","title":"Authentication"}]},{"path":"scalars","title":"Scalars","items":null}]}]},{"path":"greendonut","title":"Green Donut","description":"Configure data loaders and caching for GraphQL endpoints.","versions":[{"path":"","title":"v11 (latest)","items":[{"path":"index","title":"Introduction","items":null}]},{"path":"v10","title":"v10 (previous)","items":[{"path":"index","title":"Introduction","items":null},{"path":"installation","title":"Installation","items":null},{"path":"usage","title":"Usage","items":null},{"path":"api","title":"API","items":null},{"path":"advanced-concepts","title":"Advanced Concepts","items":[{"path":"index","title":"Custom DataLoader"},{"path":"diagnostics","title":"Diagnostic Events"}]}]}]}]}},"pageContext":{"originPath":"greendonut/v10/advanced-concepts/diagnostics.md"}},"staticQueryHashes":["1014893094","2890364758","4218812017"]}